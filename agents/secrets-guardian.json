{
  "name": "secrets-guardian",
  "description": "Security agent that detects and prevents exposure of secrets, API keys, tokens, and sensitive information",
  "type": "security",
  "capabilities": [
    "scan_for_secrets",
    "validate_environment_variables",
    "check_file_permissions",
    "audit_code_changes"
  ],
  "patterns": {
    "api_keys": [
      "(api[_-]?key|apikey)[\\s]*[:=][\\s]*['\"]?([A-Za-z0-9+/_-]{20,})['\"]?",
      "(secret[_-]?key|secretkey)[\\s]*[:=][\\s]*['\"]?([A-Za-z0-9+/_-]{20,})['\"]?",
      "sk-[A-Za-z0-9_-]{20,}",
      "bearer[\\s]+[A-Za-z0-9\\-._~+/]{20,}",
      "[A-Z][A-Z0-9_]*(_KEY|_TOKEN|_SECRET)[\\s]*[:=][\\s]*['\"]?[A-Za-z0-9+/_-]{10,}['\"]?"
    ],
    "aws_credentials": [
      "aws[_-]?access[_-]?key[_-]?id[\\s]*[:=][\\s]*['\"]?(AKIA[A-Z0-9]{16})['\"]?",
      "aws[_-]?secret[_-]?access[_-]?key[\\s]*[:=][\\s]*['\"]?([A-Za-z0-9+/]{40})['\"]?"
    ],
    "private_keys": [
      "-----BEGIN (RSA |EC |DSA |OPENSSH |)?PRIVATE KEY-----",
      "-----BEGIN PGP PRIVATE KEY BLOCK-----"
    ],
    "tokens": [
      "(github[_-]?token|gh[_-]?token)[\\s]*[:=][\\s]*['\"]?([A-Za-z0-9_-]{20,})['\"]?",
      "gh[ps]_[A-Za-z0-9]{20,}",
      "(slack[_-]?token)[\\s]*[:=][\\s]*['\"]?(xox[baprs]-[A-Za-z0-9-]{10,})['\"]?",
      "(jwt|json[_-]?web[_-]?token)[\\s]*[:=][\\s]*['\"]?(ey[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+)['\"]?"
    ],
    "database_urls": [
      "(mongodb(\\+srv)?://)[^\\s]+:[^\\s]+@[^\\s]+",
      "(postgres(ql)?://|mysql://)[^\\s]+:[^\\s]+@[^\\s]+",
      "redis://[^\\s]+:[^\\s]+@[^\\s]+"
    ],
    "passwords": [
      "(password|passwd|pwd)[\\s]*[:=][\\s]*['\"]?([^\\s'\"]{8,})['\"]?",
      "(db[_-]?pass|database[_-]?password)[\\s]*[:=][\\s]*['\"]?([^\\s'\"]{8,})['\"]?"
    ]
  },
  "response_format": {
    "status": "safe|warning|danger",
    "secrets_found": [],
    "recommendations": [],
    "blocked": false
  }
}